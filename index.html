<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fill-in í¬ë¡œìŠ¤ì›Œë“œ í¼ì¦ ìƒì„±ê¸°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
       @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap'); /* Noto Sans KR í°íŠ¸ë¡œ í†µì¼ */

        body {
            font-family: 'Noto Sans KR', sans-serif; /* Noto Sans KR í°íŠ¸ ì ìš© */
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3); /* ì€ì€í•œ ê·¸ë¦¼ì ì¶”ê°€ */
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(102, 126, 234, 0.5);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .info {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 10px;
            color: #555;
            font-size: 16px;
            box-shadow: inset 0 1px 5px rgba(0,0,0,0.1);
        }
        
        .crossword-container {
            display: flex;
            gap: 30px;
            margin-top: 30px;
            flex-wrap: wrap;
            justify-content: center; /* ë‚´ìš©ì„ ê°€ë¡œë¡œ ì¤‘ì•™ ì •ë ¬ */
        }
        
        .grid-container {
            flex: 1;
            min-width: 320px; /* ë°˜ì‘í˜•ì„ ìœ„í•œ ìµœì†Œ ë„ˆë¹„ ì¡°ì • */
            max-width: 450px; /* ê·¸ë¦¬ë“œ ì»¨í…Œì´ë„ˆì˜ ìµœëŒ€ ë„ˆë¹„ (ì¹¸ í¬ê¸° ì¡°ì ˆì˜ ê¸°ì¤€) */
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .crossword-grid {
            display: grid;
            gap: 1px;
            background-color: #333;
            border: 2px solid #333;
            margin-bottom: 20px;
            width: fit-content; /* ê·¸ë¦¬ë“œ ë‚´ìš©ì— ë§ê²Œ ë„ˆë¹„ ì¡°ì • */
        }
        
        .cell {
            background-color: #e0e7ee; /* ì…€ ë°°ê²½ìƒ‰ì„ ë” ë°ê²Œ */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px; /* ë” ì‘ì€ ì…€ì— ë§ê²Œ ê¸€ê¼´ í¬ê¸° ì¡°ì • */
            font-weight: bold;
            position: relative;
            border: 1px solid #a0aec0; /* ì…€ í…Œë‘ë¦¬ë¥¼ ë” ë¶€ë“œëŸ¬ìš´ íšŒìƒ‰ìœ¼ë¡œ */
            box-sizing: border-box; /* íŒ¨ë”©/í…Œë‘ë¦¬ë¥¼ ì…€ ë„ˆë¹„/ë†’ì´ì— í¬í•¨ */
            box-shadow: inset 0 0 3px rgba(0,0,0,0.05); /* ì€ì€í•œ ë‚´ë¶€ ê·¸ë¦¼ì ì¶”ê°€ */
        }
        
        .cell.black {
            background-color: #333;
            border: none; /* ê²€ì€ ì…€ì—ëŠ” í…Œë‘ë¦¬ ì—†ìŒ */
            box-shadow: none; /* ê²€ì€ ì…€ì—ëŠ” ê·¸ë¦¼ì ì—†ìŒ */
        }
        
        .cell .number {
            position: absolute;
            top: 1px;
            left: 1px;
            font-size: 8px; /* ìˆ«ì ê¸€ê¼´ í¬ê¸° ì¡°ì • */
            color: #666;
        }
        
        .words-section {
            flex: 1;
            min-width: 280px; /* ìµœì†Œ ë„ˆë¹„ ì¡°ì • */
            max-width: 400px;
            padding-left: 10px; /* íŒ¨ë”© ì¶”ê°€ */
        }
        
        .words-section h3 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        
        .word-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); /* ë‹¨ì–´ì— ë§ê²Œ minmax ì¡°ì • */
            gap: 8px; /* ë‹¨ì–´ ê°„ ê°„ê²© ì¤„ì„ */
            padding: 0;
            list-style: none;
        }
        
        .word-list li {
            background: #f8f9fa;
            padding: 6px 10px; /* íŒ¨ë”© ì¡°ì • */
            border-radius: 6px;
            text-align: center;
            font-weight: bold;
            border: 2px solid #e9ecef;
            transition: all 0.2s ease;
            font-size: 0.9em; /* ë‹¨ì–´ ê¸€ê¼´ì„ ì•½ê°„ ì‘ê²Œ */
            overflow-wrap: break-word; /* ê¸´ ë‹¨ì–´ ì¤„ ë°”ê¿ˆ */
        }
        
        .word-list li:hover {
            background: #e3f2fd;
            border-color: #667eea;
        }
        
        .loading {
            text-align: center;
            color: #667eea;
            font-size: 18px;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .toggle-buttons {
            text-align: center;
            margin: 15px 0 25px 0; /* ì—¬ë°± ì¡°ì • */
        }
        
        .toggle-buttons button {
            margin: 0 8px; /* ì—¬ë°± ì¡°ì • */
            padding: 10px 18px; /* íŒ¨ë”© ì¡°ì • */
            font-size: 14px;
            background: linear-gradient(45deg, #28a745, #20c997); /* í† ê¸€ ë²„íŠ¼ ìƒ‰ìƒ ë³€ê²½ */
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
        }

        .toggle-buttons button:hover {
            box-shadow: 0 6px 18px rgba(40, 167, 69, 0.5);
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
            position: fixed; /* ì œìë¦¬ì— ê³ ì • */
            z-index: 1000; /* ë§¨ ìœ„ */
            left: 0;
            top: 0;
            width: 100%; /* ì „ì²´ ë„ˆë¹„ */
            height: 100%; /* ì „ì²´ ë†’ì´ */
            overflow: auto; /* í•„ìš”ì‹œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
            background-color: rgba(0,0,0,0.6); /* ë¶ˆíˆ¬ëª…ë„ ìˆëŠ” ê²€ì€ìƒ‰ */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 30px;
            border: 1px solid #888;
            border-radius: 15px;
            width: 80%; /* ë°˜ì‘í˜• */
            max-width: 400px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute; /* ëª¨ë‹¬ ë‚´ìš©ì— ìƒëŒ€ì ìœ¼ë¡œ ìœ„ì¹˜ */
            top: 10px;
            right: 15px;
        }

        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        .modal-message {
            margin-bottom: 20px;
            font-size: 1.1em;
            color: #444;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§© Fill-in í¬ë¡œìŠ¤ì›Œë“œ í¼ì¦ ìƒì„±ê¸°</h1>
        
        <div class="controls">
            <button onclick="generateCrossword()">ìƒˆ í¬ë¡œìŠ¤ì›Œë“œ ìƒì„±</button>
            <button onclick="downloadPDF()" id="downloadBtn" disabled>PDFë¡œ ì €ì¥</button>
        </div>
        
        <div class="info">
            <strong>ğŸ¯ Fill-in í¬ë¡œìŠ¤ì›Œë“œ:</strong> ì•„ë˜ ë‹¨ì–´ë“¤ì„ ë³´ê³  ë¹ˆ ê²©ìì— ë¼ì›Œë§ì¶° ë³´ì„¸ìš”!
        </div>
        
        <div id="loading" class="loading" style="display: none;">
            í¬ë¡œìŠ¤ì›Œë“œë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤... â³
        </div>
        
        <div class="crossword-container" id="crosswordContainer" style="display: none;">
            <div class="grid-container">
                <div class="toggle-buttons">
                    <button onclick="showEmptyGrid()">ë¹ˆ ê²©ì ë³´ê¸°</button>
                    <button onclick="showAnswerGrid()">ì •ë‹µ ë³´ê¸°</button>
                    <!-- íŒíŠ¸ ë³´ê¸° (ê¸€ì í•˜ë‚˜ ê³µê°œ) ë²„íŠ¼ ì œê±° -->
                </div>
                <div id="crosswordGrid" class="crossword-grid"></div>
            </div>
            
            <div class="words-section">
                <h3>ğŸ”¤ ì‚¬ìš©í•  ë‹¨ì–´ë“¤</h3>
                <ul id="wordList" class="word-list"></ul>
            </div>
        </div>
    </div>

    <!-- Custom Modal for Alerts -->
    <div id="myModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <p id="modalMessage" class="modal-message"></p>
            <button onclick="closeModal()">í™•ì¸</button>
        </div>
    </div>

    <script>
        // Challenging word database (intermediate to advanced words)
        // ë„ì „ì ì¸ ë‹¨ì–´ ë°ì´í„°ë² ì´ìŠ¤ (ì¤‘ê¸‰~ê³ ê¸‰ ë‹¨ì–´ ì¤‘ì‹¬)
        const wordDatabase = [
            // 3-4 letter simple words (3-4 ê¸€ì ê°„ë‹¨í•œ ë‹¨ì–´)
            'CAT', 'DOG', 'SUN', 'MOON', 'RUN', 'JUMP', 'BLUE', 'RED', 'FISH', 'BIRD',
            'TREE', 'CAR', 'BOOK', 'OPEN', 'CLOSE', 'DAY', 'NIGHT', 'READ', 'SING', 'PLAY',
            'FOOD', 'WATER', 'FIRE', 'HOME', 'LOVE', 'DARK', 'LIGHT', 'STAR', 'WALK', 'TALK',
            'GAME', 'TOWN', 'CITY', 'ROAD', 'GATE', 'HOPE', 'FREE', 'CUTE', 'LOUD', 'QUIZ',
            'LAMP', 'MAP', 'BAG', 'BOX', 'COIN', 'CUP', 'EAR', 'EYE', 'FARM', 'GIFT',
            'HAT', 'ICE', 'JET', 'KEY', 'LION', 'MILK', 'NEST', 'OWL', 'PIG', 'RAIN',
            'ROSE', 'SALT', 'TAPE', 'VASE', 'WIND', 'YARN', 'ZINC', 'ANT', 'BUS', 'DISH',
            'EGG', 'FAN', 'FOX', 'GOAT', 'HEN', 'INK', 'JAM', 'KITE', 'LEG', 'MAT',
            'NUT', 'OAR', 'PEN', 'QUILL', 'RING', 'SODA', 'TENT', 'VAN', 'WEB', 'YOGA',
            'ZOO', 'BEAR', 'CAKE', 'DICE', 'DUCK', 'FISH', 'FROG', 'GUM', 'HORN', 'IRON',
            'JUICE', 'KICK', 'LAKE', 'MINT', 'MOTH', 'NAIL', 'OVAL', 'PUMP', 'QUIT', 'ROOT',
            'SOAP', 'TAXI', 'TRAY', 'VOTE', 'WOLF', 'YAWN', 'ZERO',
            
            // 5-7 letter intermediate words (5-7 ê¸€ì ì¤‘ê¸‰ ë‹¨ì–´)
            'APPLE', 'BRAVE', 'CLOUDS', 'DREAM', 'EAGLE', 'FANCY', 'GRAPE', 'HAPPY', 'IDEAL', 'JOLLY',
            'KITES', 'LIGHT', 'MAGIC', 'NIGHT', 'OCEAN', 'PEACE', 'QUIET', 'RIVER', 'STORY', 'TIGER',
            'UNION', 'VIOLET', 'WALRUS', 'XENON', 'YIELD', 'ZONES', 'AMONG', 'BEACH', 'CRANE', 'DAISY',
            'ENJOY', 'FROGS', 'GIANT', 'HASTY', 'IMAGE', 'JEWEL', 'KNEEL', 'LEMON', 'MOOSE', 'NOBLE',
            'OASIS', 'PLUTO', 'QUICK', 'ROBIN', 'SNAIL', 'TRUTH', 'ULTRA', 'VITAL', 'WAVES', 'YOUTH',
            'ZEBRA', 'QUEST', 'BLAZE', 'FJORD', 'WALTZ', 'JUDGE', 'PROXY', 'QUOTE', 'WHISK', 'BRISK',
            'QUILT', 'YACHT', 'SPHINX', 'RHYTHM', 'GALAXY', 'FROZEN', 'SYNTAX', 'OXYGEN', 'ENZYME', 'MATRIX',
            'FABRIC', 'WISDOM', 'SEQUEL', 'KNIGHT', 'VOYAGE', 'BEACON', 'ENIGMA', 'TEMPLE', 'SPHERE', 'BRONZE',
            'AUTUMN', 'MARBLE', 'JUNGLE', 'FLAVOR', 'GENIUS', 'PORTAL', 'VERTEX', 'ORCHID', 'MAGNET', 'CORPUS',
            
            // 8-10 letter upper-intermediate words (8-10 ê¸€ì ì¤‘ìƒê¸‰ ë‹¨ì–´)
            'ABSTRACT', 'BEHAVIOR', 'COMPUTER', 'DIALOGUE', 'EXCHANGE', 'FUNCTION', 'GRAPHICS', 'HOSPITAL',
            'IDENTITY', 'JEALOUSY', 'KEYBOARD', 'LANGUAGE', 'MAGNETIC', 'NEGATIVE', 'OBJECTIVE', 'PAVILION',
            'QUANTITY', 'RESEARCH', 'SANDWICH', 'TRIANGLE', 'UMBRELLA', 'VELOCITY', 'WORKSHOP', 'XYLOPHONE',
            'YEARBOOK', 'ZEPPELIN', 'BACTERIA', 'CAMPAIGN', 'DESIGNER', 'EQUATION', 'FESTIVAL',
            'GRACEFUL', 'HANDBOOK', 'IDENTIFY', 'JUNCTION', 'KANGAROO', 'LANDMARK', 'MAGAZINE', 'NOTEBOOK',
            'ELEPHANT', 'SPECTRUM', 'TWILIGHT', 'UNIVERSE', 'VARIABLE', 'WIRELESS', 'ACADEMIC',
            'BASEMENT', 'CREATURE', 'DIAMOND', 'FOUNTAIN', 'GARDENER', 'INCIDENT',
            'JOYSTICK', 'NONSENSE', 'OBSTACLE', 'PARADISE', 'QUESTION', 'ABUNDANT', 'CAPTURED', 'DECORATE',
            'ELEGANCE', 'FANTASTIC', 'GENEROUS', 'HARMONY', 'ILLUSION', 'JOURNAL', 'LUSCIOUS', 'MYSTERIOUS',
            'NARRATOR', 'OVERCOME', 'POSITIVE', 'QUALIFIED', 'RADIANCE', 'SERENITY', 'TREASURE', 'UNDERTAKE',
            'VIBRANT', 'WONDERFUL', 'YACHTING', 'ADVENTURE', 'BRILLIANT', 'CHAMPION', 'DISCOVER', 'ESSENCE',

            // Academic/Technical terms (í•™ìˆ /ê¸°ìˆ  ìš©ì–´) - 10ê¸€ì ì´í•˜ ìœ ì§€
            'ALGORITHM', 'BANDWIDTH', 'CHEMISTRY', 'DATABASE', 'ECOSYSTEM', 'FRAMEWORK', 'GENETICS', 'HISTOGRAM',
            'INTERFACE', 'JAVASCRIPT', 'KINEMATIC', 'LOGISTICS', 'MICROWAVE', 'NEUROLOGY', 'ORCHESTRA', 'PROTOCOL',
            'QUARANTINE', 'RADIATION', 'SYNTHESIS', 'TELESCOPE', 'VOCABULARY', 'WAVELENGTH', 'XEROGRAPHY',
            'ZOOLOGY', 'CRYPTOGRAPHY', 'DEMOGRAPHICS', 'SEISMOLOGY',
            'QUANTUM', 'ROBOTICS', 'STATISTICS', 'TECHNOLOGY', 'VIRTUAL', 'WIKIPEDIA', 'YOUTUBE',
            'ZIGZAG', 'ANALYSIS', 'BIOLOGY', 'CALCULUS', 'DATASET', 'FORMULA', 'GEOMETRY', 'HYPOTHESIS',
            'INNOVATION', 'JUNCTURE', 'LABORATORY', 'METADATA', 'NEUTRONS', 'OPTICS', 'PARADIGM', 'QUOTIENT', 'RESOLUTION',
            
            // Advanced adjectives/adverbs (ê³ ê¸‰ í˜•ìš©ì‚¬/ë¶€ì‚¬) - 10ê¸€ì ì´í•˜ ìœ ì§€
            'MAGNIFICENT', 'SPECTACULAR', 'TREMENDOUS', 'INCREDIBLE', 'OUTSTANDING', 'REMARKABLE',
            'EXCEPTIONAL', 'PHENOMENAL', 'ASTONISHING', 'BREATHTAKING', 'OVERWHELMING', 'UNPRECEDENTED',
            'SOPHISTICATED', 'COMPREHENSIVE', 'EXPERIMENTAL',
            'FUNDAMENTAL', 'INTELLECTUAL', 'PROFESSIONAL', 'TECHNOLOGICAL', 'PHILOSOPHICAL', 'PSYCHOLOGICAL',
            'ABSOLUTELY', 'ACCURATELY', 'ADAPTIVELY', 'BEAUTIFULLY', 'CAREFULLY', 'COMPLETELY', 'CONSISTENTLY',
            'DEFINITELY', 'EFFORTLESSLY', 'ESPECIALLY', 'EXACTLY', 'EXTENSIVELY', 'FREQUENTLY', 'GRADUALLY',
            'IMMEDIATELY', 'INCREASINGLY', 'INNOVATIVELY', 'LEGITIMATELY', 'NECESSARILY', 'OPTIMALLY', 'PARTICULARLY',
            'POTENTIALLY', 'PRECISELY', 'RAPIDLY', 'RELIABLY', 'SIGNIFICANTLY', 'SUCCESSFULLY', 'ULTIMATELY',
            
            // Compound words/Specialized terms (ë³µí•©ì–´/ì „ë¬¸ ìš©ì–´) - 10ê¸€ì ì´í•˜ ìœ ì§€
            'BREAKTHROUGH', 'MARKETPLACE', 'SPOKESPERSON', 'HEADQUARTERS',
            'NEVERTHELESS', 'FURTHERMORE', 'CONSEQUENCE', 'SIGNIFICANCE', 'MAINTENANCE', 'PERFORMANCE',
            'ARCHITECTURE', 'MATHEMATICS', 'PHOTOGRAPHY', 'BIBLIOGRAPHY', 'CHOREOGRAPHY',
            'AUTOBIOGRAPHY', 'CHAMPIONSHIP', 'RELATIONSHIP', 'WORKMANSHIP',
            'ENCYCLOPEDIA', 'THUNDERSTORM', 'GRASSHOPPER', 'TOOTHBRUSH', 'EARTHQUAKE',
            'BACKGROUND', 'BASKETBALL', 'BUTTERFLY', 'CAREFREE', 'DAYLIGHT', 'DOORWAY', 'EVERYTHING', 'FIREFLY',
            'FORECAST', 'GOLDFISH', 'GRANDCHILD', 'HEADLIGHT', 'HOUSEPLANT', 'KEYSTONE', 'LANDSCAPE', 'LIFETIME',
            'MOONLIGHT', 'OUTSTANDING', 'OVERNIGHT', 'PASSPORT', 'RAINDROP', 'SEASHELL', 'SUNFLOWER', 'TEACUP',
            'UNDERWATER', 'WATERFALL', 'WITHOUT', 'WORKOUT', 'ZIPPER'
        ];

        let currentGrid = null;
        let currentWords = null;
        let answerGrid = null;
        let showingAnswer = false;
        const GRID_SIZE = 21; // í†µì¼ëœ ê·¸ë¦¬ë“œ í¬ê¸°

        // ì»¤ìŠ¤í…€ ëª¨ë‹¬ì„ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function showModal(message) {
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('myModal').style.display = 'flex'; // ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•´ flex ì‚¬ìš©
        }

        // ì»¤ìŠ¤í…€ ëª¨ë‹¬ì„ ë‹«ëŠ” í•¨ìˆ˜
        function closeModal() {
            document.getElementById('myModal').style.display = 'none';
        }

        // í¬ë¡œìŠ¤ì›Œë“œë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
        function generateCrossword() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('crosswordContainer').style.display = 'none';
            document.getElementById('downloadBtn').disabled = true;
            
            // ì»¨í…Œì´ë„ˆë¥¼ ë¨¼ì € ë³´ì´ê²Œ í•˜ì—¬ offsetWidthê°€ ì˜¬ë°”ë¥´ê²Œ ê³„ì‚°ë˜ë„ë¡ í•¨
            document.getElementById('crosswordContainer').style.display = 'flex'; 

            setTimeout(() => {
                const result = createFillInCrossword(GRID_SIZE);
                
                // ì¶©ë¶„í•œ ë‹¨ì–´ê°€ ë°°ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸
                if (result && result.words.length > 5) {
                    currentGrid = result.emptyGrid;
                    answerGrid = result.answerGrid;
                    currentWords = result.words;
                    showingAnswer = false;
                    displayCrossword(currentGrid, currentWords, GRID_SIZE);
                    document.getElementById('downloadBtn').disabled = false;
                    
                    // í¼ì¦ ìƒì„± í›„ ê¸°ë³¸ì ìœ¼ë¡œ íŒíŠ¸ ê¸€ì í•˜ë‚˜ ê³µê°œ
                    revealHintLetterInternal(); 

                } else {
                    showModal('í¬ë¡œìŠ¤ì›Œë“œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ì¶©ë¶„í•œ ë‹¨ì–´ê°€ ë°°ì¹˜ë˜ì§€ ì•ŠìŒ) ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                }
                
                document.getElementById('loading').style.display = 'none';
            }, 1500);
        }

        // ì±„ì›Œë„£ê¸° í¬ë¡œìŠ¤ì›Œë“œë¥¼ ìƒì„±í•˜ëŠ” í•µì‹¬ ë¡œì§
        function createFillInCrossword(size) {
            const grid = Array(size).fill(null).map(() => Array(size).fill(''));
            const answerGrid = Array(size).fill(null).map(() => Array(size).fill(''));
            const emptyGrid = Array(size).fill(null).map(() => Array(size).fill(''));
            const usedWords = [];
            
            // ë‹¨ì–´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì„ê³  ê¸¸ì´(3~10ì)ì— ë”°ë¼ í•„í„°ë§
            let shuffledAndFilteredWords = [...wordDatabase]
                .filter(word => word.length >= 3 && word.length <= 10)
                .sort(() => Math.random() - 0.5); // ë‹¨ì–´ë¥¼ í•œ ë²ˆë§Œ ì„ìŠµë‹ˆë‹¤.

            if (shuffledAndFilteredWords.length === 0) return null; // ë°°ì¹˜í•  ë‹¨ì–´ê°€ ì—†ìœ¼ë©´ null ë°˜í™˜

            // 1. ì²« ë²ˆì§¸ ë‹¨ì–´ ë°°ì¹˜ (ë¬´ì‘ìœ„ë¡œ ì„ íƒ)
            const firstWord = shuffledAndFilteredWords.shift(); // ì„ì¸ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì²« ë‹¨ì–´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const startRow = Math.floor(size / 2);
            const startCol = Math.floor((size - firstWord.length) / 2);
            
            if (firstWord && startCol >= 0 && startCol + firstWord.length <= size) {
                for (let i = 0; i < firstWord.length; i++) {
                    grid[startRow][startCol + i] = firstWord[i];
                    answerGrid[startRow][startCol + i] = firstWord[i];
                }
                usedWords.push(firstWord);
            } else {
                return null; // ì²« ë‹¨ì–´ë¥¼ ë°°ì¹˜í•  ìˆ˜ ì—†ìœ¼ë©´ null ë°˜í™˜
            }

            // 2. ë‚¨ì€ ë‹¨ì–´ë“¤ì„ êµì°¨ì ì„ ì°¾ì•„ ë°°ì¹˜ ì‹œë„ (ëª©í‘œ ê°œìˆ˜ê¹Œì§€)
            const targetWordCount = 25; // í¼ì¦ì— ë°°ì¹˜í•  ëª©í‘œ ë‹¨ì–´ ê°œìˆ˜

            for (const word of shuffledAndFilteredWords) { // ë‚¨ì€ ì„ì¸ ë‹¨ì–´ë“¤ì„ ìˆœíšŒ
                if (usedWords.length >= targetWordCount) break; // ëª©í‘œ ê°œìˆ˜ì— ë„ë‹¬í•˜ë©´ ì¤‘ë‹¨

                const placement = findIntersection(grid, word, size);
                
                if (placement) {
                    placeWord(grid, word, placement);
                    placeWord(answerGrid, word, placement);
                    usedWords.push(word);
                }
            }
            
            // ë¹ˆ ê·¸ë¦¬ë“œ ìƒì„± (ë¹ˆ ì¹¸ì€ ê²€ì€ ì…€, ì±„ì›Œì§„ ì¹¸ì€ ë¹ˆ í”Œë ˆì´ ê°€ëŠ¥í•œ ì…€)
            for (let row = 0; row < size; row++) {
                for (let col = 0; col < size; col++) {
                    if (grid[row][col] === '') {
                        emptyGrid[row][col] = ''; // ê²€ì€ ì…€
                    } else {
                        emptyGrid[row][col] = ' '; // ë¹ˆ í”Œë ˆì´ ê°€ëŠ¥ ì…€
                    }
                }
            }
            
            return { 
                emptyGrid: emptyGrid, 
                answerGrid: answerGrid, 
                words: usedWords.sort((a, b) => a.length - b.length || a.localeCompare(b)) // ì‚¬ìš©ëœ ë‹¨ì–´ ì •ë ¬
            };
        }

        // ë‹¨ì–´ê°€ ê·¸ë¦¬ë“œì— êµì°¨í•  ìˆ˜ ìˆëŠ” ìœ„ì¹˜ë¥¼ ì°¾ëŠ” í•¨ìˆ˜
        function findIntersection(grid, word, size) {
            const validPlacements = [];
            
            // ê¸°ì¡´ ê·¸ë¦¬ë“œ ì…€ì„ ìˆœíšŒ
            for (let row = 0; row < size; row++) {
                for (let col = 0; col < size; col++) {
                    if (grid[row][col] && grid[row][col] !== '') { // ì…€ì— ê¸€ìê°€ ìˆìœ¼ë©´
                        const gridLetter = grid[row][col];
                        
                        // í˜„ì¬ ë‹¨ì–´ê°€ ì´ ê¸€ìë¥¼ í¬í•¨í•˜ëŠ”ì§€ í™•ì¸
                        for (let i = 0; i < word.length; i++) {
                            if (word[i] === gridLetter) {
                                // ê°€ë¡œ ë°°ì¹˜ ì‹œë„
                                const hCol = col - i;
                                if (canPlaceHorizontal(grid, word, row, hCol, size)) {
                                    validPlacements.push({
                                        row: row,
                                        col: hCol,
                                        direction: 'across'
                                    });
                                }
                                
                                // ì„¸ë¡œ ë°°ì¹˜ ì‹œë„
                                const vRow = row - i;
                                if (canPlaceVertical(grid, word, vRow, col, size)) {
                                    validPlacements.push({
                                        row: vRow,
                                        col: col,
                                        direction: 'down'
                                    });
                                }
                            }
                        }
                    }
                }
            }
            
            // ìœ íš¨í•œ ë°°ì¹˜ ì¤‘ ë¬´ì‘ìœ„ í•˜ë‚˜ë¥¼ ë°˜í™˜, ì—†ìœ¼ë©´ null ë°˜í™˜
            return validPlacements.length > 0 ? validPlacements[Math.floor(Math.random() * validPlacements.length)] : null;
        }

        // ë‹¨ì–´ë¥¼ ê°€ë¡œë¡œ ë°°ì¹˜í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function canPlaceHorizontal(grid, word, row, col, size) {
            // ê²½ê³„ í™•ì¸
            if (col < 0 || col + word.length > size || row < 0 || row >= size) return false;
            
            // ì•ë’¤ ì…€ì´ ë¹„ì–´ ìˆëŠ”ì§€ í™•ì¸
            if (col > 0 && grid[row][col - 1] !== '') return false;
            if (col + word.length < size && grid[row][col + word.length] !== '') return false;
            
            for (let i = 0; i < word.length; i++) {
                const currentCell = grid[row][col + i];
                // ì…€ì´ ë‹¤ë¥¸ ê¸€ìë¡œ ì±„ì›Œì ¸ ìˆê±°ë‚˜ ê¸€ìê°€ ìˆì–´ì•¼ í•  ê²€ì€ ì…€ì¸ ê²½ìš°
                if (currentCell !== '' && currentCell !== word[i]) {
                    return false;
                }
                
                // í˜„ì¬ ì…€ì´ ë¹„ì–´ ìˆìœ¼ë©´ ìœ„ì•„ë˜ ì…€ì— ì¶©ëŒí•˜ëŠ” ê¸€ìê°€ ìˆëŠ”ì§€ í™•ì¸
                if (currentCell === '') {
                    if (row > 0 && grid[row - 1][col + i] !== '') return false;
                    if (row < size - 1 && grid[row + 1][col + i] !== '') return false;
                }
            }
            
            return true;
        }

        // ë‹¨ì–´ë¥¼ ì„¸ë¡œë¡œ ë°°ì¹˜í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function canPlaceVertical(grid, word, row, col, size) {
            // ê²½ê³„ í™•ì¸
            if (row < 0 || row + word.length > size || col < 0 || col >= size) return false;
            
            // ìœ„ì•„ë˜ ì…€ì´ ë¹„ì–´ ìˆëŠ”ì§€ í™•ì¸
            if (row > 0 && grid[row - 1][col] !== '') return false;
            if (row + word.length < size && grid[row + word.length][col] !== '') return false;
            
            for (let i = 0; i < word.length; i++) {
                const currentCell = grid[row + i][col];
                // ì…€ì´ ë‹¤ë¥¸ ê¸€ìë¡œ ì±„ì›Œì ¸ ìˆê±°ë‚˜ ê¸€ìê°€ ìˆì–´ì•¼ í•  ê²€ì€ ì…€ì¸ ê²½ìš°
                if (currentCell !== '' && currentCell !== word[i]) {
                    return false;
                }
                
                // í˜„ì¬ ì…€ì´ ë¹„ì–´ ìˆìœ¼ë©´ ì¢Œìš° ì…€ì— ì¶©ëŒí•˜ëŠ” ê¸€ìê°€ ìˆëŠ”ì§€ í™•ì¸
                if (currentCell === '') {
                    if (col > 0 && grid[row + i][col - 1] !== '') return false;
                    if (col < size - 1 && grid[row + i][col + 1] !== '') return false;
                }
            }
            
            return true;
        }

        // ë‹¨ì–´ë¥¼ ê·¸ë¦¬ë“œì— ë°°ì¹˜í•˜ëŠ” í•¨ìˆ˜
        function placeWord(grid, word, placement) {
            if (placement.direction === 'across') { // ê°€ë¡œ ë°©í–¥
                for (let i = 0; i < word.length; i++) {
                    grid[placement.row][placement.col + i] = word[i];
                }
            } else { // ì„¸ë¡œ ë°©í–¥ ('down')
                for (let i = 0; i < word.length; i++) {
                    grid[placement.row + i][placement.col] = word[i];
                }
            }
        }

        // í¬ë¡œìŠ¤ì›Œë“œë¥¼ HTMLì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function displayCrossword(grid, words, size) {
            const gridContainer = document.getElementById('crosswordGrid');
            const gridContainerMaxWidth = 450; // CSSì— ì„¤ì •ëœ .grid-containerì˜ max-width
            const cellSize = gridContainerMaxWidth / size; 
            
            gridContainer.style.gridTemplateColumns = `repeat(${size}, ${cellSize}px)`;
            gridContainer.innerHTML = '';
            
            for (let row = 0; row < size; row++) {
                for (let col = 0; col < size; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    // ë™ì ìœ¼ë¡œ ê³„ì‚°ëœ ì…€ í¬ê¸°ë¥¼ ì ìš©í•©ë‹ˆë‹¤.
                    cell.style.width = `${cellSize}px`;
                    cell.style.height = `${cellSize}px`;
                    
                    if (grid[row][col] === '') {
                        cell.className += ' black'; // ê²€ì€ ì…€
                    } else { // ê¸€ìê°€ ìˆê±°ë‚˜ ë¹ˆ í”Œë ˆì´ ê°€ëŠ¥ ì…€
                        cell.style.backgroundColor = 'white';
                        cell.style.border = '0.5px solid #ccc';
                        cell.textContent = grid[row][col] === ' ' ? '' : grid[row][col]; // ' ' ì´ë©´ ë¹ˆ ì¹¸, ì•„ë‹ˆë©´ ê¸€ì í‘œì‹œ
                    }
                    
                    gridContainer.appendChild(cell);
                }
            }
            
            // ë‹¨ì–´ ëª©ë¡ í‘œì‹œ
            document.getElementById('wordList').innerHTML = words.map(word => `<li>${word}</li>`).join('');
        }

        // ë¹ˆ ê²©ìë¥¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
        function showEmptyGrid() {
            if (currentGrid) {
                showingAnswer = false;
                displayCrossword(currentGrid, currentWords, GRID_SIZE);
            }
        }

        // ì •ë‹µ ê²©ìë¥¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
        function showAnswerGrid() {
            if (answerGrid) {
                showingAnswer = true;
                displayCrossword(answerGrid, currentWords, GRID_SIZE);
            }
        }

        // íŒíŠ¸ ê¸€ì í•˜ë‚˜ë¥¼ ê³µê°œí•˜ëŠ” í•¨ìˆ˜
        // ì´ í•¨ìˆ˜ëŠ” 'íŒíŠ¸ ë³´ê¸°' ë²„íŠ¼ì´ ì œê±°ë˜ì—ˆìœ¼ë¯€ë¡œ ë‚´ë¶€ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
        function revealHintLetterInternal() {
            const emptyPlayableCells = []; // ë¹ˆ ì¹¸ì˜ ì¢Œí‘œë¥¼ ì €ì¥í•  ë°°ì—´

            for (let r = 0; r < GRID_SIZE; r++) {
                for (let c = 0; c < GRID_SIZE; c++) {
                    // í˜„ì¬ ê·¸ë¦¬ë“œì—ì„œëŠ” ë¹ˆ ì¹¸ì´ë©´ì„œ, ì •ë‹µ ê·¸ë¦¬ë“œì—ëŠ” ê¸€ìê°€ ìˆëŠ” ì¹¸ë§Œ ì„ íƒ
                    if (currentGrid[r][c] === ' ' && answerGrid[r][c] !== '') {
                        emptyPlayableCells.push({ row: r, col: c });
                    }
                }
            }

            if (emptyPlayableCells.length === 0) {
                //showModal('ë” ì´ìƒ ê³µê°œí•  ìˆ˜ ìˆëŠ” ë¹ˆ ì¹¸ì´ ì—†ìŠµë‹ˆë‹¤. ëª¨ë“  ê¸€ìê°€ ì±„ì›Œì¡Œê±°ë‚˜, ë” ì´ìƒ ë†“ì„ ê³³ì´ ì—†ìŠµë‹ˆë‹¤!');
                return; // ëª¨ë‹¬ ë©”ì‹œì§€ëŠ” ë²„íŠ¼ì´ ì—†ìœ¼ë¯€ë¡œ ì£¼ì„ ì²˜ë¦¬
            }

            // ë¬´ì‘ìœ„ë¡œ í•˜ë‚˜ì˜ ë¹ˆ ì¹¸ ì„ íƒ
            const randomIndex = Math.floor(Math.random() * emptyPlayableCells.length);
            const { row, col } = emptyPlayableCells[randomIndex];

            // ì„ íƒëœ ì¹¸ì— ì •ë‹µ ê¸€ì ê³µê°œ
            currentGrid[row][col] = answerGrid[row][col];
            displayCrossword(currentGrid, currentWords, GRID_SIZE);
        }


        // PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
        function downloadPDF() {
            if (!currentGrid || !currentWords || !answerGrid) {
                showModal('PDFë¥¼ ë‹¤ìš´ë¡œë“œí•  í¬ë¡œìŠ¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const size = GRID_SIZE; // í†µì¼ëœ ê·¸ë¦¬ë“œ í¬ê¸° ì‚¬ìš©
            
            // PDFì— í•œê¸€ì„ ì§€ì›í•˜ë ¤ë©´ í•œê¸€ í°íŠ¸ë¥¼ ì„ë² ë“œí•´ì•¼ í•©ë‹ˆë‹¤.
            // ì´ ì˜ˆì‹œëŠ” ì˜ì–´ì— ì í•©í•œ ê¸°ë³¸ í°íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
            // ë§Œì•½ PDFì— í•œê¸€ í…ìŠ¤íŠ¸ê°€ í•„ìˆ˜ì ì´ë¼ë©´ ë‹¤ìŒì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤:
            // doc.addFont('font-name.ttf', 'font-family', 'normal');
            // doc.setFont('font-family');
            
            // ì œëª©
            doc.setFontSize(20);
            doc.text('Fill-in Crossword Puzzle', 105, 20, { align: 'center' });
            
            doc.setFontSize(12);
            doc.text('Fill in the empty squares using the words listed below.', 105, 30, { align: 'center' });
            
            // í¼ì¦ìš© ë¹ˆ ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸°
            const puzzleStartX = 20;
            const puzzleStartY = 45; // Y ìœ„ì¹˜ ì¡°ì •
            const puzzleCellSize = 7; // PDFìš© ì…€ í¬ê¸° ì¡°ì • (21x21 ê·¸ë¦¬ë“œ)
            
            for (let row = 0; row < size; row++) {
                for (let col = 0; col < size; col++) {
                    const x = puzzleStartX + col * puzzleCellSize;
                    const y = puzzleStartY + row * puzzleCellSize;
                    
                    if (currentGrid[row][col] === '') {
                        doc.setFillColor(0, 0, 0);
                        doc.rect(x, y, puzzleCellSize, puzzleCellSize, 'F');
                    } else {
                        doc.setFillColor(255, 255, 255);
                        doc.rect(x, y, puzzleCellSize, puzzleCellSize, 'FD');
                        // íŒíŠ¸ë¡œ ê³µê°œëœ ê¸€ìê°€ ìˆë‹¤ë©´ PDF í¼ì¦ì—ë„ í‘œì‹œ
                        if (currentGrid[row][col] !== ' ') {
                            doc.setFontSize(puzzleCellSize * 0.6); // ì…€ í¬ê¸°ì— ë¹„ë¡€í•˜ì—¬ í°íŠ¸ í¬ê¸° ì¡°ì •
                            doc.text(currentGrid[row][col], x + puzzleCellSize * 0.1, y + puzzleCellSize * 0.75);
                        }
                    }
                }
            }
            
            // ë‹¨ì–´ ëª©ë¡
            let wordsListStartY = puzzleStartY + size * puzzleCellSize + 20;
            doc.setFontSize(14);
            doc.text('Words to use:', puzzleStartX, wordsListStartY);
            wordsListStartY += 10;
            
            doc.setFontSize(10);
            let xPos = puzzleStartX;
            const wordsPerRow = 5; // í•œ ì¤„ì— ë” ë§ì€ ë‹¨ì–´ë¥¼ ìœ„í•œ ë ˆì´ì•„ì›ƒ ì¡°ì •
            const wordColWidth = 35; // ë‹¨ì–´ì˜ ì—´ ë„ˆë¹„ ì¡°ì •

            currentWords.forEach((word, index) => {
                if (index > 0 && index % wordsPerRow === 0) {
                    wordsListStartY += 8;
                    xPos = puzzleStartX;
                }
                
                doc.text(word, xPos, wordsListStartY);
                xPos += wordColWidth;
                
                // ë‚´ìš©ì´ ë„˜ì¹˜ë©´ ìƒˆ í˜ì´ì§€ ì¶”ê°€
                if (wordsListStartY > 270) {
                    doc.addPage();
                    wordsListStartY = 20;
                    xPos = puzzleStartX;
                }
            });
            
            // ì •ë‹µ ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸° (ìƒˆ í˜ì´ì§€ í•˜ë‹¨ ë˜ëŠ” ê³µê°„ì´ ìˆìœ¼ë©´ ê°™ì€ í˜ì´ì§€ì—)
            if (wordsListStartY + 80 > 270) { // ê³µê°„ì´ ì¶©ë¶„í•œì§€ í™•ì¸, ì•„ë‹ˆë©´ ìƒˆ í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                wordsListStartY = 20; // ìƒˆ í˜ì´ì§€ë¥¼ ìœ„í•´ Y ì¬ì„¤ì •
            }
            const answerGridStartX = 20; // ì‹œì‘ X ìœ„ì¹˜ë¥¼ ì™¼ìª½ìœ¼ë¡œ ì´ë™í•˜ì—¬ ë” í¬ê²Œ ë³´ì´ê²Œ í•¨
            const answerGridStartY = wordsListStartY + 20;
            const answerCellSize = 4.0; // ì •ë‹µ í‚¤ ì…€ í¬ê¸°ë¥¼ ë” í‚¤ì›€ (2.5 -> 4.0)
            
            doc.setFontSize(10); // ì •ë‹µ ê·¸ë¦¬ë“œ ì œëª© ê¸€ì í¬ê¸°
            doc.text('Answer:', answerGridStartX, answerGridStartY - 5);
            
            for (let row = 0; row < size; row++) {
                for (let col = 0; col < size; col++) {
                    const x = answerGridStartX + col * answerCellSize;
                    const y = answerGridStartY + row * answerCellSize;
                    
                    if (answerGrid[row][col] === '') {
                        doc.setFillColor(0, 0, 0);
                        doc.rect(x, y, answerCellSize, answerCellSize, 'F');
                    } else {
                        doc.setFillColor(255, 255, 255);
                        doc.rect(x, y, answerCellSize, answerCellSize, 'FD');
                        
                        doc.setFontSize(5); // ì •ë‹µ ê¸€ìë¥¼ ìœ„í•œ ê¸€ê¼´ í¬ê¸° í‚¤ì›€ (3.5 -> 5)
                        doc.text(answerGrid[row][col], x + answerCellSize * 0.25, y + answerCellSize * 0.7); // ì…€ ì¤‘ì•™ì— ê°€ê¹ê²Œ ì¡°ì •
                    }
                }
            }
            
            doc.save(`fill-in-crossword-${Date.now()}.pdf`);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ í¬ë¡œìŠ¤ì›Œë“œ ìƒì„±
        window.addEventListener('load', () => {
            generateCrossword();
        });
    </script>
</body>
</html>
